define("banjiajia/web/1.0.0/scripts/members/teacher/resume",["$","handlebars","util","ace-elements"],function(a){function b(){this.$addApendTemplate=c("#addApend-Template"),this.$addSuccLabelTemplate=c("#addSuccLabel-Template"),this.Flag=!0,this.removeFlag=!0,this.updFlag=!0}var c=a("$"),d=a("handlebars"),e=a("util"),f=new e;a("ace-elements"),b.prototype.addSetting=function(){return{title:"学习经历",unitDescb:"学校",professionDescb:"专业"}},b.prototype.saveParmasSetting=function(){return{teacherId:c("#teacherId").val(),title:"",timeDescb:"",unitDescb:"",professionDescb:""}},b.prototype.init=function(){var a=this;f.ajaxGlobalSetting(),a.certificate(),a.loadEvent(),a.addBox()},b.prototype.dateRange=function(){c("input[name=timeDescb]").daterangepicker({singleDatePicker:!0,showDropdowns:!0,format:"YYYY.MM",minDate:"1980.01",maxDate:"2020.01"}).prev().on(ace.click_event,function(){c(this).next().focus()})},b.prototype.saveResume=function(a,b){var e=this;e.Flag&&c.ajax({type:"POST",url:_contentPath+"/members/teacher/add/resume.json",data:a,dataType:"json",beforeSend:function(){e.Flag=!1},success:function(a){if("1"==a){var c=e.$addSuccLabelTemplate.html(),f=d.compile(c);b.$Ibox.html(f(b))}},complete:function(){e.Flag=!0}})},b.prototype.successCheck=function(){},b.prototype.saveBtn=function(){var a=this;c(".saveBtn").click(function(){var b=a.saveParmasSetting(),d=c(this).parents("div.ibox-content"),e=c(this).attr("data-parent-id");b.title=d.find("input[name='title']").val(),b.timeDescb=d.find("input[name='timeDescb']").val(),b.unitDescb=d.find("input[name='unitDescb']").val(),b.professionDescb=d.find("input[name='professionDescb']").val();var f=a.getSettting(e),g={$Ibox:d,timeDescb:b.timeDescb,unitDescb:f.unitDescb,unitDescbLabel:b.unitDescb,professionDescb:f.professionDescb,professionDescbLabel:b.professionDescb};a.saveResume(b,g)})},b.prototype.getSettting=function(a){var b=this,c=b.addSetting();return"work"==a?(c.title="工作经历",c.unitDescb="公司",c.professionDescb="职位"):(c.title="学习经历",c.unitDescb="学校",c.professionDescb="专业"),c},b.prototype.addBox=function(){var a=this;c(".addBox").click(function(){var b=c(this).attr("data-parent-id"),e=a.getSettting(b),f=a.$addApendTemplate.html(),g=d.compile(f),h=c("#"+b).find("div.ibox-content");h&&h.length>0?c("#"+b).find(".ibox-content:first").before(g(e)):c("#"+b).find("div.ibox").append(g(e)),a.loadEvent()})},b.prototype.removeBox=function(){var a=this;c(".removeBtn").click(function(){var b=c(this).parents("div.ibox-content");a.removePost({resuMeId:c(this).attr("data-id"),ibox:b})})},b.prototype.removePost=function(a){var b=this;b.removeFlag&&c.ajax({type:"POST",url:_contentPath+"/members/teacher/remove/resume/"+a.resuMeId+".json",dataType:"json",beforeSend:function(){b.removeFlag=!1},success:function(b){"1"==b&&a.ibox.remove()},complete:function(){b.removeFlag=!0}})},b.prototype.updResume=function(a){var b=this;b.updFlag&&c.ajax({type:"POST",url:_contentPath+"/members/teacher/edit/resume.json",data:a,dataType:"json",beforeSend:function(){b.updFlag=!1},success:function(a){"1"==a&&(location.href=location.href)},complete:function(){b.updFlag=!0}})},b.prototype.updBtn=function(){var a=this;c(".updBtn").click(function(){var b=a.saveParmasSetting(),d=c(this).parents("div.ibox-content"),e=c(this).attr("data-parent-id");b.id=c(this).next(".removeBtn").attr("data-id"),b.title=d.find("input[name='title']").val(),b.timeDescb=d.find("input[name='timeDescb']").val(),b.unitDescb=d.find("input[name='unitDescb']").val(),b.professionDescb=d.find("input[name='professionDescb']").val();var f=a.getSettting(e),g={$Ibox:d,id:c(this).next(".removeBtn").attr("data-id"),timeDescb:b.timeDescb,unitDescb:f.unitDescb,unitDescbLabel:b.unitDescb,professionDescb:f.professionDescb,professionDescbLabel:b.professionDescb};a.updResume(b,g)})},b.prototype.loadEvent=function(){var a=this;a.dateRange(),a.cancelBox(),a.saveBtn(),a.removeBox(),a.updBtn()},b.prototype.cancelBox=function(){c(".cancelBtn").click(function(){c(this).parents("div.ibox-content").remove()})},b.prototype.certificate=function(){function a(){b.init(),h.init()}var b={init:function(){var a=this;c(".addBoxPro").click(function(){var b=c(this).attr("data-parent-id"),d=c("#addprofile-Template").html(),e=c("#"+b).find("div.ibox-content");e&&e.length>0?c("#"+b).find(".ibox-content:first").before(d):c("#"+b).find("div.ibox").append(d),a.cancel(),h.init()})},cancel:function(){c(".cancelProBtn").click(function(){c(this).parents("div.ibox-content").remove()})}},e=!0,f=!0,g=!0,h={init:function(){var a=this;a.click(),a.editClick(),a.removeBox(),a.selInIt()},selInIt:function(){var a=c(".profileSel");a.each(function(){c(this).val(c(this).attr("data-val"))})},parmasSetting:function(){return{teacherId:c("#teacherId").val(),profileName:"",profileNum:"",profileId:1,descb:""}},click:function(){var a=this;c(".saveProBtn").click(function(){var b=a.parmasSetting(),d=c(this).parents("div.ibox-content");c(this).attr("data-parent-id"),b.profileName=d.find("input[name='profileName']").val(),b.profileNum=d.find("input[name='profileNum']").val(),b.descb=d.find("textarea[name='descb']").val(),b.profileId=d.find("select[name='profileN']").val();var e={$Ibox:d,profileName:b.profileName,profileNum:b.profileNum,descb:b.descb,profileId:d.find("select[name='profileN']").find("option:selected").text()};a.save(b,e)})},save:function(a,b){e&&c.ajax({type:"POST",url:_contentPath+"/members/teacher/add/profile.json",data:a,dataType:"json",beforeSend:function(){e=!1},success:function(a){if("1"==a){var e=c("#addprofileLabel-Template").html(),f=d.compile(e);b.$Ibox.html(f(b))}},complete:function(){e=!0}})},editClick:function(){var a=this;c(".updProBtn").click(function(){var b=a.parmasSetting(),d=c(this).parents("div.ibox-content");c(this).attr("data-parent-id"),b.id=c(this).next(".removeProBtn").attr("data-id"),b.profileName=d.find("input[name='profileName']").val(),b.profileNum=d.find("input[name='profileNum']").val(),b.descb=d.find("textarea[name='descb']").val(),b.profileId=d.find("select[name='profileN']").val(),{$Ibox:d,profileName:b.profileName,profileNum:b.profileNum,descb:b.descb,profileId:d.find("select[name='profileN']").text()},a.edit(b)})},edit:function(a){f&&c.ajax({type:"POST",url:_contentPath+"/members/teacher/edit/profile.json",data:a,dataType:"json",beforeSend:function(){f=!1},success:function(a){"1"==a&&(location.href=location.href)},complete:function(){f=!0}})},removeBox:function(){var a=this;c(".removeProBtn").click(function(){var b=c(this).parents("div.ibox-content");a.remove({proId:c(this).attr("data-id"),ibox:b})})},remove:function(a){g&&c.ajax({type:"POST",url:_contentPath+"/members/teacher/remove/profile/"+a.proId+".json",dataType:"json",beforeSend:function(){g=!1},success:function(b){"1"==b&&a.ibox.remove()},complete:function(){g=!0}})}};a()},(new b).init()});
