Date.prototype.Format = function (fmt) { //author: meizz     var o = {        "M+": this.getMonth() + 1, //月份         "d+": this.getDate(), //日         "H+": this.getHours(), //小时         "m+": this.getMinutes(), //分         "s+": this.getSeconds(), //秒         "q+": Math.floor((this.getMonth() + 3) / 3), //季度         "S": this.getMilliseconds() //毫秒     };    if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));    for (var k in o)    if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));    return fmt;}/* * product list  --douzy */define(function(require,exports,module){	var $=require("$"),Pager=require("pager"),Util=require("util"),State=require("state");	var util=new  Util();	util.ajaxGlobalSetting();	require("ace-elements");	require("jggrid");	require("gridlocale");	require("validation")($);	var plugin=require("plugin");	var Util=require("util");	var util=new Util();	var theacertbody = $("#theacertbody");	var pageSize=0;		$.fn.datetimepicker.dates['zh-CN'] = {			days: ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"],			daysShort: ["周日", "周一", "周二", "周三", "周四", "周五", "周六", "周日"],			daysMin:  ["日", "一", "二", "三", "四", "五", "六", "日"],			months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],			monthsShort: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],			today: "今天",			suffix: [],			meridiem: ["上午", "下午"]	};		$('.date-picker').datetimepicker({language: 'zh-CN',todayBtn: 1,autoclose:true}).next().on(ace.click_event, function(){		$(this).prev().focus();	});		var parmasArr=new Array();	function  relaodDate(result){		var theacertbodyHtml="";		for ( var teacher in result.data) {			theacertbodyHtml+=teacherTr(result.data[teacher]);		}				theacertbody.html(theacertbodyHtml);		pageSize=result.page.length;		var option={				totalPages:result.page.total,				currentPage:result.page.current,				callback:fetchData			};		Pager.init($(".pagination"),option);				$(".advertCon").click(function(){            var self=$(this);            var con=$(this).attr("data-content");            var $tbody=$("#refoundtbody");            $tbody.html("")            var html="";            var conArr=con.split("@");            var arrLength = conArr.length;            for(var i=0;i<arrLength;i++){                var con=conArr[i];                var html="";                if(con !== null && con !== undefined && con !== ''){                	 if(i == 0){                     	html+="<tr>";                     	html+='<td>店铺招牌图片</td>';                         html+='<td><img width="100px"  height="180px"  class=" img-responsive"   src="'+con+'"></td>';                         html+='<td></td>';                         html+="</tr>"                     }else{                     	var conMyArr=con.split(";");                     	html+="<tr>";                     	html+='<td>产品简介及链接地址</td>';                        html+='<td><img width="100px"  height="180px"  class=" img-responsive"   src="'+ conMyArr[0] +'"></td>';                        html+='<td><a href="http://'+ conMyArr[1] + '" target="_blank">' + conMyArr[1] + '</a></td>';                        html+="</tr>"                     }                }                $tbody.append(html);            }            $("#myModal").modal("show");        });        $(".examine").click(function(){            $("#examineId").val($(this).attr("data-id"));            $("#examineModal").modal("show");        });        $(".btn-success").click(function(){            var examineId= parseInt($("#examineId").val());            var remark = "亲，恭喜您，您的主页已经审核通过啦，快去进行首页推广吧。";            if(examineId>0) {                $.ajax({                    url: _contentPath + '/businessShop/pass.json?id=' + examineId + '&state=1&remark='+remark,                    async: true,                    dataType: 'json',                    success: function (data) {                        if(!!data) {                            $("#examineModal").modal("hide");                            alert(data.msg);                            location=location;                        }                    },                    error: function (jqXHR, textStatus, errorThrown) {                        console.log("error=" + errorThrown);                    }                });            }        });        $(".btn-danger").click(function(){            var examineId= parseInt($("#examineId").val());            if(examineId>0) {            	var pass = $("#pass").val();            	if(pass == null || pass == undefined || pass == ''){            		alert("请说明审核失败原因!");            		return;            	}                $.ajax({                    url: _contentPath + '/businessShop/noPass.json?id=' + examineId + '&state=2&remark='+pass,                    async: true,                    dataType: 'json',                    success: function (data) {                        if(!!data) {                            $("#examineModal").modal("hide");                            alert(data.msg);                            location=location;                        }                    },                    error: function (jqXHR, textStatus, errorThrown) {                        console.log("error=" + errorThrown);                    }                });            }        });	}		function teacherTr(data){		var html="";		var shopSign = data.shopSign;		var firstPic = data.firstPic;		var secondPic = data.secondPic;		var thirdPic = data.thirdPic;		var fourPic = data.fourPic;		var fivePic = data.fivePic;		var sixPic = data.sixPic;        var str="";        if(shopSign !== null && shopSign !== undefined && shopSign !== ''){        	str+=shopSign+"@";        }        if(firstPic !== null && firstPic !== undefined && firstPic !== ''){        	str+=firstPic+"@";        }        if(secondPic !== null && secondPic !== undefined && secondPic !== ''){        	str+=secondPic+"@";        }        if(thirdPic !== null && thirdPic !== undefined && thirdPic !== ''){        	str+=thirdPic+"@";        }        if(fourPic !== null && fourPic !== undefined && fourPic !== ''){        	str+=fourPic+"@";        }        if(fivePic !== null && fivePic !== undefined && fivePic !== ''){        	str+=fivePic+"@";        }        if(sixPic !== null && sixPic !== undefined && sixPic !== ''){        	str+=sixPic+"@";        }        var stateStr = '待审核';        var state = data.state;        if(state == 1){        	stateStr = "审核通过";        }else if(state == 2){        	stateStr = "审核未通过";        }		html+='<tr class="odd">'+		'<td class=" ">'+(data.userId != null ? data.userId : "")+'</td>'+		'<td class=" ">'+(data.nickName != null ? data.nickName : "")+'</td>'+		'<td class=" ">'+(data.phone != null ? data.phone : "")+'</td>'+		'<td class=" ">'+(!!data.createTime?new Date(data.createTime).Format("yyyy-MM-dd HH:mm:ss"):"")+'</td>'+		'<td class=" ">'+(!!data.modifyTime?new Date(data.modifyTime).Format("yyyy-MM-dd HH:mm:ss"):"")+'</td>'+		'<td class=" ">'+stateStr+'</td>'+//		'<td class=" ">'+(data.shopSign != null ? data.shopSign : "")+'</td>'+//		'<td class=" ">'+(data.firstPic != null ? data.firstPic : "")+'</td>'+//		'<td class=" ">'+(data.secondPic != null ? data.secondPic : "")+'</td>'+//		'<td class=" ">'+(data.thirdPic != null ? data.thirdPic : "")+'</td>'+//		'<td class=" ">'+(data.fourPic != null ? data.fourPic : "")+'</td>'+//		'<td class=" ">'+(data.fivePic != null ? data.fivePic : "")+'</td>'+//		'<td class=" ">'+(data.sixPic != null ? data.sixPic : "")+'</td>'+//		'<td class=" ">'+(data.about != null ? data.about : "")+'</td>'+		'<td class=""><a data-content="'+str+'" class="advertCon" >查看</a></td>'+		'<td class=" ">'+(data.about != null ? data.about : "")+'</td>'+		'<td class=" ">'+(data.remark != null ? data.remark : "")+'</td>'+		'<td class=" ">'+        '<div class="visible-md visible-lg hidden-sm hidden-xs action-buttons">'+       ( data.state == 0 ?         '<a class="green examine" href="javascript:void(0);" data-id="'+data.id+'"><i class="icon-pencil bigger-130"></i></a>'        :'' )+'</div>'+        '</td>'+		'</tr>';		return html;	}		function initFunction(){				$("#serchBtn").click(function(){			var filed=$(this).attr("data-fild");			parmasArr=new Array();			parmasArr.push(filed+"="+encodeURI(encodeURI($("#searchValue").val())))			parmasArr.push("startTime="+$("#id-date-picker-3").val());			parmasArr.push("endTime="+$("#id-date-picker-4").val());			fetchData(null,null,null,1);		});				/*$("#exportBtn").click(function(){			var filed=$(this).attr("data-fild");			parmasArr=new Array();			parmasArr.push(filed+"="+encodeURI(encodeURI($("#searchValue").val())));			parmasArr.push("startTime="+$("#id-date-picker-3").val());			parmasArr.push("endTime="+$("#id-date-picker-4").val());			window.location = _contentPath + '/agent/promotion/export.json?' + parmasArr.join("&");		});*/			}		function enableTooltips(table) {		$('.navtable .ui-pg-button').tooltip({container:'body'});		$(table).find('.ui-pg-div').tooltip({container:'body'});	}	function fetchData(event, originalEvent, type,page){		var begin=(parseInt(page)-1)*pageSize;		$.ajax({	        url: _contentPath+'/businessShop/list/query.json?begin='+begin+"&"+parmasArr.join("&"),	        async: true,	        dataType: 'json',	        success: function(data){	        	        	relaodDate(data.businessShops);	        },	       	        error: function(jqXHR , textStatus , errorThrown){	          console.log("error="+errorThrown);	        }	  });	}	var func = {			init : function() {				fetchData(null,null,null,0);				initFunction();				var plugin_bootstrap=new plugin().bootstrap();				plugin_bootstrap.dropdownInIt();				plugin_bootstrap.dropDownAlone();			}		};			func.init();		});