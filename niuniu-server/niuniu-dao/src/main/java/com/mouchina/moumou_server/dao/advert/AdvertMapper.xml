<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mouchina.moumou_server.dao.advert.AdvertMapper">
	<resultMap id="BaseResultMap"
		type="com.mouchina.moumou_server.entity.advert.Advert">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Feb 01 
			15:47:43 CST 2016. -->
		<id column="id" property="id" jdbcType="BIGINT" />
		<result column="advert_type" property="advertType" jdbcType="INTEGER" />
		<result column="state" property="state" jdbcType="TINYINT" />
		<result column="user_id" property="userId" jdbcType="BIGINT" />
		<result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
		<result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP" />
		<result column="start_time" property="startTime" jdbcType="TIMESTAMP" />
		<result column="end_time" property="endTime" jdbcType="TIMESTAMP" />
		<result column="red_envelope_type" property="redEnvelopeType"
			jdbcType="INTEGER" />
		<result column="red_envelope_amount" property="redEnvelopeAmount"
			jdbcType="INTEGER" />
		<result column="red_envelope_count" property="redEnvelopeCount"
			jdbcType="INTEGER" />
		<result column="advert_name" property="advertName" jdbcType="VARCHAR" />
		<result column="advert_content" property="advertContent"
			jdbcType="VARCHAR" />
		<result column="advert_condition_city" property="adverConditionCity"
			jdbcType="VARCHAR" />
		<result column="advert_condition_area" property="adverConditionArea"
			jdbcType="VARCHAR" />
		<result column="advert_condition_province" property="adverConditionProvince" />

		<result column="website_name" property="websiteName" jdbcType="VARCHAR" />
		<result column="advert_condition_distance" property="adverCondtionDistance"
			jdbcType="INTEGER" />
		<result column="advert_condition_sex" property="adverCondtionSex"
			jdbcType="INTEGER" />
		<result column="advert_condition_age_scope" property="adverCondtionAgeScope"
			jdbcType="INTEGER" />
		<result column="salary_scope" property="salaryScope" jdbcType="VARCHAR" />
		<result column="time_scope" property="timeScope" jdbcType="VARCHAR" />
		<result column="label_type" property="labelType" jdbcType="INTEGER" />
		<result column="married" property="married" jdbcType="TINYINT" />
		<result column="preferred_pic" property="preferredPic"
			jdbcType="VARCHAR" />
		<result column="relation_id" property="relationId" jdbcType="BIGINT" />
		<result column="certification_type" property="certificationType"
			jdbcType="INTEGER" />
		<result column="business_tel" property="businessTel" jdbcType="VARCHAR" />
		<result column="business_address" property="businessAddress"
			jdbcType="VARCHAR" />
		<result column="province" property="province" jdbcType="VARCHAR" />
		<result column="city" property="city" jdbcType="VARCHAR" />
		<result column="area" property="area" jdbcType="VARCHAR" />
		<result column="comment_size" property="commentSize" jdbcType="INTEGER" />
		<result column="praised_size" property="praisedSize" jdbcType="INTEGER" />
		<result column="business_name" property="businessName"
			jdbcType="VARCHAR" />
		<result column="hobby" property="hobby" jdbcType="VARCHAR" />
		<result column="work" property="work" jdbcType="VARCHAR" />
		<result column="longitude" property="longitude" jdbcType="DOUBLE" />
		<result column="latitude" property="latitude" jdbcType="DOUBLE" />
	</resultMap>

	<resultMap id="BannerBaseResultMap"
		type="com.mouchina.moumou_server.entity.advert.BannerConfig">
		<id column="id" property="id" jdbcType="BIGINT" />
		<result column="pic_url" property="picUrl" jdbcType="VARCHAR" />
		<result column="second_level_url" property="secondLevelUrl"
			jdbcType="INTEGER" />
		<result column="pic_index" property="picIndex" jdbcType="INTEGER" />
		<result column="banner_type" property="bannerType" jdbcType="INTEGER" />
		<result column="flag" property="flag" jdbcType="INTEGER" />
		<result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
		<result column="modify_time" property="modifyTime" jdbcType="TIMESTAMP" />
	</resultMap>

	<resultMap id="PublicWelFaretVoMap"
		type="com.mouchina.moumou_server.entity.vo.PublicWelFareAdvertVo"
		extends="BaseResultMap">
		<result column="send_red_envelope_count" property="sendRedEnvelopeCount"
			jdbcType="INTEGER" />
		<result column="send_red_envelope_amount" property="sendRedEnvelopeAmount"
			jdbcType="INTEGER" />
	</resultMap>

	<sql id="Base_Column_List">
		ad.id,
		ad.advert_type,
		ad.state,
		ad.user_id,
		ad.create_time,
		ad.modify_time,
		ad.start_time,
		ad.end_time,
		ad.red_envelope_type,
		ad.red_envelope_amount,
		ad.red_envelope_count,
		bs.business_name
		business_name,
		bs.certification_type,
		bs.business_tel,
		bs.business_address,
		bs.province,
		bs.city,
		bs.area,
		advert_name,
		ad.advert_content,
		ad.advert_condition_city,
		ad.advert_condition_area,
		ad.advert_condition_province,
		ad.website_name,
		ad.advert_condition_distance,
		ad.advert_condition_sex,
		ad.advert_condition_age_scope,
		ad.salary_scope,
		ad.time_scope,
		ad.label_type,
		ad.married,
		ad.preferred_pic,
		ad.relation_id,
		ad.longitude,
		ad.latitude
	</sql>

	<sql id="select_Advert_Base_Column_List">
		ad.id,
		ad.advert_type,
		ad.state,
		ad.user_id,
		ad.create_time,
		ad.modify_time,
		ad.start_time,
		ad.end_time,
		ad.red_envelope_type,
		ad.red_envelope_amount,
		ad.red_envelope_count,
		ad.advert_name,
		ad.advert_content,
		ad.advert_condition_city,
		ad.advert_condition_area,
		ad.advert_condition_province,
		ad.advert_condition_distance,
		ad.advert_condition_sex,
		ad.advert_condition_age_scope,
		ad.website_name,
		ad.salary_scope,
		ad.time_scope,
		ad.label_type,
		ad.married,
		ad.preferred_pic,
		ad.relation_id,
		ad.comment_size,
		ad.praised_size
	</sql>

	<sql id="Banner_Base_Column_List">
		id,
		pic_url,
		second_level_url,
		pic_index,
		banner_type,
		flag,
		create_time,
		modify_time
	</sql>

	<!-- 根据主键查询一条广告 -->
	<select id="selectAdvertByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select
		<include refid="select_Advert_Base_Column_List" />
		from moumou.advert ad where ad.id = #{id,jdbcType=BIGINT}
	</select>

	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select
		<include refid="Base_Column_List" />
		from moumou.advert ad INNER JOIN moumou.business bs ON ad.user_id =
		bs.user_id
		where ad.id = #{id,jdbcType=BIGINT}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Feb 01 
			15:47:43 CST 2016. -->
		delete from advert
		where id = #{id,jdbcType=BIGINT}
	</delete>
	<insert id="insert" parameterType="com.mouchina.moumou_server.entity.advert.Advert">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Feb 01 
			15:47:43 CST 2016. -->
		insert into advert (id, advert_type, state,
		user_id, create_time,
		modify_time,
		start_time, end_time, red_envelope_type,
		red_envelope_amount, red_envelope_count, advert_name,
		advert_content,
		advert_condition_city, advert_condition_area,
		advert_condition_province,
		advert_condition_distance,
		advert_condition_sex, advert_condition_age_scope
		)
		values
		(#{id,jdbcType=BIGINT}, #{advertType,jdbcType=INTEGER},
		#{state,jdbcType=TINYINT},
		#{userId,jdbcType=BIGINT},
		#{createTime,jdbcType=TIMESTAMP}, #{modifyTime,jdbcType=TIMESTAMP},
		#{startTime,jdbcType=TIMESTAMP}, #{endTime,jdbcType=TIMESTAMP},
		#{redEnvelopeType,jdbcType=INTEGER},
		#{redEnvelopeAmount,jdbcType=INTEGER},
		#{redEnvelopeCount,jdbcType=INTEGER}, #{advertName,jdbcType=VARCHAR},
		#{advertContent,jdbcType=VARCHAR},
		#{advertConditionCity,jdbcType=VARCHAR},
		#{advertConditionArea,jdbcType=VARCHAR},
		#{advertConditionProvince,jdbcType=VARCHAR},
		#{advertCondtionDistance,jdbcType=INTEGER},
		#{advertCondtionSex,jdbcType=INTEGER},
		#{advertCondtionAgeScope,jdbcType=INTEGER},
		#{hobby,jdbcType=VARCHAR},
		#{work,jdbcType=VARCHAR},
		#{longitude,jdbcType=DOUBLE},
		#{latitude,jdbcType=DOUBLE}
		)
	</insert>
	<insert id="insertSelective" parameterType="com.mouchina.moumou_server.entity.advert.Advert">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Feb 01 
			15:47:43 CST 2016. -->
		insert into advert
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="advertType != null">
				advert_type,
			</if>
			<if test="state != null">
				state,
			</if>
			<if test="userId != null">
				user_id,
			</if>
			<if test="createTime != null">
				create_time,
			</if>
			<if test="modifyTime != null">
				modify_time,
			</if>
			<if test="startTime != null">
				start_time,
			</if>
			<if test="endTime != null">
				end_time,
			</if>
			<if test="redEnvelopeType != null">
				red_envelope_type,
			</if>
			<if test="redEnvelopeAmount != null">
				red_envelope_amount,
			</if>
			<if test="redEnvelopeCount != null">
				red_envelope_count,
			</if>
			<if test="advertName != null">
				advert_name,
			</if>
			<if test="advertContent != null">
				advert_content,
			</if>
			<if test="adverConditionCity != null">
				advert_condition_city,
			</if>
			<if test="adverConditionArea != null">
				advert_condition_area,
			</if>
			<if test="adverConditionProvince != null">
				advert_condition_province,
			</if>
			<if test="adverCondtionDistance != null">
				advert_condition_distance,
			</if>
			<if test="adverCondtionSex != null">
				advert_condition_sex,
			</if>
			<if test="adverCondtionAgeScope != null">
				advert_condition_age_scope,
			</if>
			<if test="websiteName != null">
				website_name,
			</if>
			<if test="commentSize != null">
				comment_size,
			</if>
			<if test="salaryScope != null">
				salary_scope,
			</if>
			<if test="timeScope != null">
				time_scope,
			</if>
			<if test="labelType != null">
				label_type,
			</if>
			<if test="married != null">
				married,
			</if>
			<if test="preferredPic != null">
				preferred_pic,
			</if>
			<if test="relationId != null">
				relation_id,
			</if>
			<if test="hobby != null">
				hobby,
			</if>
			<if test="work != null">
				work,
			</if>
			<if test="longitude != null">
				longitude,
			</if>
			<if test="latitude != null">
				latitude,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=BIGINT},
			</if>
			<if test="advertType != null">
				#{advertType,jdbcType=INTEGER},
			</if>
			<if test="state != null">
				#{state,jdbcType=TINYINT},
			</if>
			<if test="userId != null">
				#{userId,jdbcType=BIGINT},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyTime != null">
				#{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="startTime != null">
				#{startTime,jdbcType=TIMESTAMP},
			</if>
			<if test="endTime != null">
				#{endTime,jdbcType=TIMESTAMP},
			</if>
			<if test="redEnvelopeType != null">
				#{redEnvelopeType,jdbcType=INTEGER},
			</if>
			<if test="redEnvelopeAmount != null">
				#{redEnvelopeAmount,jdbcType=INTEGER},
			</if>
			<if test="redEnvelopeCount != null">
				#{redEnvelopeCount,jdbcType=INTEGER},
			</if>
			<if test="advertName != null">
				#{advertName,jdbcType=VARCHAR},
			</if>
			<if test="advertContent != null">
				#{advertContent,jdbcType=VARCHAR},
			</if>
			<if test="adverConditionCity != null">
				#{adverConditionCity,jdbcType=VARCHAR},
			</if>
			<if test="adverConditionArea != null">
				#{adverConditionArea,jdbcType=VARCHAR},
			</if>
			<if test="adverConditionProvince != null">
				#{adverConditionProvince,jdbcType=VARCHAR},
			</if>
			<if test="adverCondtionDistance != null">
				#{adverCondtionDistance,jdbcType=INTEGER},
			</if>
			<if test="adverCondtionSex != null">
				#{adverCondtionSex,jdbcType=INTEGER},
			</if>
			<if test="adverCondtionAgeScope != null">
				#{adverCondtionAgeScope,jdbcType=VARCHAR},
			</if>
			<if test="websiteName != null">
				#{websiteName,jdbcType=VARCHAR},
			</if>
			<if test="commentSize != null">
				#{commentSize,jdbcType=INTEGER},
			</if>
			<if test="salaryScope != null">
				#{salaryScope,jdbcType=VARCHAR},
			</if>
			<if test="timeScope != null">
				#{timeScope,jdbcType=VARCHAR},
			</if>
			<if test="labelType != null">
				#{labelType,jdbcType=INTEGER},
			</if>
			<if test="married != null">
				#{married,jdbcType=TINYINT},
			</if>
			<if test="preferredPic != null">
				#{preferredPic,jdbcType=VARCHAR},
			</if>
			<if test="relationId != null">
				#{relationId,jdbcType=BIGINT},
			</if>
			<if test="hobby != null">
				#{hobby,jdbcType=VARCHAR},
			</if>
			<if test="work != null">
				#{work,jdbcType=VARCHAR},
			</if>
			<if test="longitude != null">
				#{longitude,jdbcType=DOUBLE},
			</if>
			<if test="latitude != null">
				#{latitude,jdbcType=DOUBLE},
			</if>
		</trim>
		<selectKey resultType="java.lang.Long" order="AFTER"
			keyProperty="id">
			SELECT LAST_INSERT_ID() AS ID
		</selectKey>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.mouchina.moumou_server.entity.advert.Advert">
		update advert
		<set>
			<if test="advertType != null">
				advert_type = #{advertType,jdbcType=INTEGER},
			</if>
			<if test="state != null">
				state = #{state,jdbcType=TINYINT},
			</if>
			<if test="userId != null">
				user_id = #{userId,jdbcType=BIGINT},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyTime != null">
				modify_time = #{modifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="startTime != null">
				start_time = #{startTime,jdbcType=TIMESTAMP},
			</if>
			<if test="endTime != null">
				end_time = #{endTime,jdbcType=TIMESTAMP},
			</if>
			<if test="redEnvelopeType != null">
				red_envelope_type = #{redEnvelopeType,jdbcType=INTEGER},
			</if>
			<if test="redEnvelopeAmount != null">
				red_envelope_amount =
				#{redEnvelopeAmount,jdbcType=INTEGER},
			</if>
			<if test="redEnvelopeCount != null">
				red_envelope_count =
				#{redEnvelopeCount,jdbcType=INTEGER},
			</if>
			<if test="advertName != null">
				advert_name = #{advertName,jdbcType=VARCHAR},
			</if>
			<if test="advertContent != null">
				advert_content = #{advertContent,jdbcType=VARCHAR},
			</if>
			<if test="adverConditionCity != null">
				advert_condition_city =
				#{adverConditionCity,jdbcType=VARCHAR},
			</if>
			<if test="adverConditionArea != null">
				advert_condition_area =
				#{adverConditionArea,jdbcType=VARCHAR},
			</if>
			<if test="adverConditionProvince != null">
				advert_condition_province =
				#{adverConditionProvince,jdbcType=VARCHAR},
			</if>

			<if test="adverCondtionDistance != null">
				advert_condition_distance
				=#{adverCondtionDistance,jdbcType=INTEGER},
			</if>
			<if test="adverCondtionSex != null">
				advert_condition_sex =
				#{adverCondtionSex,jdbcType=INTEGER},
			</if>
			<if test="adverCondtionAgeScope != null">
				advert_condition_age_scope =
				#{adverCondtionAgeScope,jdbcType=INTEGER},
			</if>
			<if test="websiteName != null">
				website_name= #{websiteName,jdbcType=VARCHAR},
			</if>
			<if test="salaryScope != null">
				salary_scope= #{salaryScope,jdbcType=VARCHAR},
			</if>
			<if test="timeScope != null">
				time_scope= #{timeScope,jdbcType=VARCHAR},
			</if>
			<if test="labelType != null">
				label_type = #{labelType,jdbcType=INTEGER},
			</if>
			<if test="married != null">
				married= #{married,jdbcType=TINYINT},
			</if>
			<if test="preferredPic != null">
				preferred_pic = #{preferredPic,jdbcType=VARCHAR},
			</if>
			<if test="relationId != null">
				relation_id = #{relationId,jdbcType=BIGINT},
			</if>
			<if test="commentSize != null">
				comment_size = #{commentSize,jdbcType=INTEGER},
			</if>
			<if test="praisedSize != null">
				praised_size = #{praisedSize,jdbcType=INTEGER},
			</if>
			<if test="hobby != null">
				hobby = #{hobby,jdbcType=VARCHAR},
			</if>
			<if test="work != null">
				work = #{work,jdbcType=VARCHAR},
			</if>
			<if test="longitude != null">
				longitude = #{longitude,jdbcType=DOUBLE},
			</if>
			<if test="latitude != null">
				latitude = #{latitude,jdbcType=DOUBLE},
			</if>
		</set>
		where id = #{id,jdbcType=BIGINT}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.mouchina.moumou_server.entity.advert.Advert">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Mon Feb 01 
			15:47:43 CST 2016. -->
		update advert
		set advert_type = #{advertType,jdbcType=INTEGER},
		state =
		#{state,jdbcType=TINYINT},
		user_id = #{userId,jdbcType=BIGINT},
		create_time = #{createTime,jdbcType=TIMESTAMP},
		modify_time =
		#{modifyTime,jdbcType=TIMESTAMP},
		start_time =
		#{startTime,jdbcType=TIMESTAMP},
		end_time =
		#{endTime,jdbcType=TIMESTAMP},
		red_envelope_type =
		#{redEnvelopeType,jdbcType=INTEGER},
		red_envelope_amount =
		#{redEnvelopeAmount,jdbcType=INTEGER},
		red_envelope_count =
		#{redEnvelopeCount,jdbcType=INTEGER},
		advert_name =
		#{advertName,jdbcType=VARCHAR},
		advert_content =
		#{advertContent,jdbcType=VARCHAR},
		advert_condition_city =
		#{adverConditionCity,jdbcType=VARCHAR},
		advert_condition_area =
		#{adverConditionArea,jdbcType=VARCHAR},
		advert_condition_province =
		#{adverConditionProvince,jdbcType=VARCHAR},
		advert_condition_distance =
		#{adverCondtionDistance,jdbcType=INTEGER},
		advert_condition_sex =
		#{adverCondtionSex,jdbcType=INTEGER},
		advert_condition_age_scope =
		#{adverCondtionAgeScope,jdbcType=INTEGER},
		hobby =
		#{hobby,jdbcType=VARCHAR},
		work = #{work,jdbcType=VARCHAR},
		longitude =
		#{longitude,jdbcType=DOUBLE},
		latitude = #{latitude,jdbcType=DOUBLE}
		where id =
		#{id,jdbcType=BIGINT}
	</update>
	<select id="selectModel" resultMap="BaseResultMap"
		parameterType="java.util.Map">
		select
		<include refid="Base_Column_List" />
		<include refid="selectPageCondition" />
		<if test="order != null">
      		<![CDATA[  order by  ad.${order} ]]>
		</if>
	</select>
	<select id="selectList" resultMap="BaseResultMap" parameterType="java.util.Map">
		select
		<include refid="Base_Column_List" />
		<include refid="selectPageCondition" />
		<if test="order != null">
      <![CDATA[  order by  ad.${order} ]]>
		</if>
	</select>

	<sql id="selectPageCondition">
		from moumou.advert ad inner join moumou.business bs on ad.user_id =
		bs.user_id
		<where>
			<if test="notInIds != null">
				and ad.id not in ${notInIds}
			</if>
			<if test="id != null">
				and ad.id= #{id,jdbcType=BIGINT}
			</if>
			<if test="advertType != null">
				and ad.advert_type= #{advertType,jdbcType=INTEGER}
			</if>
			<if test="advertTypes != null">
				and ad.advert_type in (${advertTypes})
			</if>
			<if test="state != null">
				and ad.state= #{state,jdbcType=TINYINT}
			</if>
			<if test="states != null">
				and ad.state in (${states})
			</if>
			<if test="userId != null">
				and ad.user_id= #{userId,jdbcType=BIGINT}
			</if>
			<if test="createTime != null">
				and ad.create_time= #{createTime,jdbcType=TIMESTAMP}
			</if>
			<if test="modifyTime != null">
				and ad.modify_time= #{modifyTime,jdbcType=TIMESTAMP}
			</if>
			<if test="startTime != null">
				and ad.start_time= #{startTime,jdbcType=TIMESTAMP}
			</if>
			<if test="endTime != null">
				and ad.end_time= #{endTime,jdbcType=TIMESTAMP}
			</if>
			<if test="redEnvelopeType != null">
				and ad.red_envelope_type=
				#{redEnvelopeType,jdbcType=INTEGER}
			</if>
			<if test="redEnvelopeAmount != null">
				and ad.red_envelope_amount=
				#{redEnvelopeAmount,jdbcType=INTEGER}
			</if>
			<if test="redEnvelopeCount != null">
				and ad.red_envelope_count=
				#{redEnvelopeCount,jdbcType=INTEGER}
			</if>
			<if test="advertName != null">
				and (ad.advert_name= #{advertName,jdbcType=VARCHAR} or
				ad.advert_name
				like
				CONCAT('%','${advertName}','%' ))
			</if>
			<if test="advertContent != null">
				and (ad.advert_content= #{advertContent,jdbcType=VARCHAR}
				or
				ad.advert_content
				like
				CONCAT('%','${advertContent}','%' ))
			</if>
			<if test="businessName != null">
				and (bs.business_name= #{businessName,jdbcType=VARCHAR}
				or
				bs.business_name
				like
				CONCAT('%','${advertContent}','%' ))
			</if>
			<if test="adverConditionCity != null">
				and (ad.advert_condition_city=
				#{adverConditionCity,jdbcType=VARCHAR}
				or ad.advert_condition_city =
				'all')
			</if>
			<if test="adverConditionArea != null">
				and (ad.advert_condition_area=
				#{adverConditionArea,jdbcType=VARCHAR}
				or ad.advert_condition_area =
				'all')
			</if>
			<if test="adverConditionProvince != null">
				and (ad.advert_condition_province=
				#{adverConditionProvince,jdbcType=VARCHAR}
				or
				ad.advert_condition_province = 'all')
			</if>

			<if test="adverCondtionDistance != null">
				and ad.advert_condition_distance=
				#{adverCondtionDistance,jdbcType=INTEGER}
			</if>
			<if test="adverCondtionSex != null">
				and ad.advert_condition_sex=
				#{adverCondtionSex,jdbcType=INTEGER}
			</if>
			<if test="adverCondtionAgeScope != null">
				and ad.advert_condition_age_scope=
				#{adverCondtionAgeScope,jdbcType=INTEGER}
			</if>
			<if test="adverCondtionAgeScopes != null">
				and (ad.advert_condition_age_scope = 0 or
				ad.advert_condition_age_scope =
				#{adverCondtionAgeScopes,jdbcType=INTEGER})
			</if>
			<if test="startTimegt != null">
				and ad.start_time >= #{startTimegt,jdbcType=TIMESTAMP}
			</if>
			<if test="startTimelt != null">
				and ad.start_time <![CDATA[  <= ]]>
				#{startTimelt,jdbcType=TIMESTAMP}
			</if>
			<if test="endTimegt != null">
				and (ad.end_time >= #{endTimegt,jdbcType=TIMESTAMP}
				or
				ad.end_time is null)
			</if>
			<if test="endTimelt != null">
				and ad.end_time <![CDATA[  <= ]]>
				#{endTimelt,jdbcType=TIMESTAMP}
			</if>
			<if test="createTimegt != null">
				and ad.create_time >= #{createTimegt,jdbcType=TIMESTAMP}
			</if>
			<if test="createTimelt != null">
				and ad.create_time <![CDATA[  <= ]]>
				#{createTimelt,jdbcType=TIMESTAMP}
			</if>
			<!-- <if test="adverCondtionAgeScopes != null"> and ( ad.advert_condition_age_scope 
				='0,' or ad.advert_condition_age_scope like CONCAT('%','${adverCondtionAgeScopes}','%' 
				)) </if> -->
			<if test="websiteName != null">
				and ad.website_name= #{websiteName,jdbcType=VARCHAR}
			</if>
			<if test="salaryScope != null">
				and ( ad.salary_scope ='0,' or ad.salary_scope like
				CONCAT('%','${salary_scope}','%' ) )
			</if>
			<if test="salaryScopes != null">
				and ( ad.salary_scope ='0,' or ad.salary_scope like
				CONCAT('%','${salaryScopes}','%' ) )
			</if>
			<if test="timeScopes != null">
				and ( ad.time_scope ='0,' or ad.time_scope like
				CONCAT('%','${timeScopes}','%' ) )
			</if>
			<if test="adverCondtionSexs != null">
				and ( ad.advert_condition_sex = 2 or
				ad.advert_condition_sex
				=#{adverCondtionSexs,jdbcType=TINYINT} )
			</if>
			<if test="labelType != null">
				and label_type = #{labelType,jdbcType=INTEGER}
			</if>
			<if test="labelTypes != null">
				and label_type in (${labelTypes})
			</if>
			<if test="married != null">
				and ad.married= #{married,jdbcType=TINYINT}
			</if>
			<if test="marrieds != null">
				and ( ad.married = 0 or ad.married
				=#{marrieds,jdbcType=TINYINT} )
			</if>
			<if test="preferredPic != null">
				and preferred_pic = #{preferredPic,jdbcType=VARCHAR}
			</if>
			<if test="relationId != null">
				relation_id = #{relationId,jdbcType=BIGINT}
			</if>
			<if test="hobby != null">
				hobby = #{hobby,jdbcType=VARCHAR}
			</if>
			<if test="hobbys0 != null">
				and ( hobby = '0' or hobby like
				CONCAT
				('%','${hobbys0}','%') )
			</if>
			<if test="hobbys1 != null">
				and ( hobby = '0' or hobby like
				CONCAT
				('%','${hobbys1}','%') )
			</if>
			<if test="hobbys2 != null">
				and ( hobby = '0' or hobby like
				CONCAT
				('%','${hobbys2}','%') )
			</if>
			<if test="work != null">
				work = #{work,jdbcType=VARCHAR}
			</if>
			<if test="works != null">
				and ( work = '0' or work like
				CONCAT ('%','${works}','%')
				)
			</if>
			<if test="longitude != null">
				longitude = #{longitude,jdbcType=DOUBLE}
			</if>
			<if test="latitude != null">
				latitude = #{latitude,jdbcType=DOUBLE}
			</if>
			<if test="crateTimeDay != null">
				and TO_DAYS(ad.create_time) = TO_DAYS(NOW())
			</if>
		</where>
	</sql>

	<select id="selectPageList" resultMap="BaseResultMap"
		parameterType="java.util.Map">
		select
		<include refid="Base_Column_List" />
		<include refid="selectPageCondition" />
		<if test="order != null">
      <![CDATA[  order by  ad.${order} ]]>
		</if>
		<if test="page != null">
      <![CDATA[  limit #{page.begin}, #{page.end} ]]>
		</if>
	</select>
	<select id="selectCount" resultType="int" parameterType="java.util.Map">
		select count(1)
		<include refid="selectPageCondition" />
	</select>
	<select id="getAdvertSumInfo" resultType="hashmap">
		SELECT
		SUM(a.red_envelope_amount) AS publishAdvertMoney,SUM(ads.view_times)
		AS
		advertScanCount,SUM(ads.send_red_envelope_count) AS
		redEnvelopePersons
		FROM
		advert AS a JOIN advert_statistics AS ads ON
		a.id=ads.advert_id
	</select>
	<select id="selectAdvertBidTop" resultType="int" parameterType="java.util.Map">
		SELECT topNum FROM
		(SELECT odr.user_id, (@r :=@r + 1) topNum FROM
		(SELECT CASE WHEN b.user_id = #{userId} THEN
		sum(IFNULL(c.red_envelope_amount, 0)) + #{amount}
		ELSE
		sum(IFNULL(c.red_envelope_amount, 0))
		END AS sum, b.user_id FROM
		(SELECT a.user_id FROM
		moumou.advert a
		WHERE a.advert_type =
		#{advertType}
		AND a.state = #{state}
		UNION
		SELECT #{userId}
		) b
		LEFT JOIN
		advert c ON b.user_id = c.user_id
		AND c.advert_type = #{advertType}
		AND
		c.state = #{state}
		GROUP BY c.user_id
		) odr, (SELECT @r := 0) b
		ORDER BY
		odr.sum DESC
		) h
		WHERE
		h.user_id = #{userId}
	</select>

	<!-- 查询首页广告(只查询50条) -->
	<select id="selectHomePageList" resultMap="BaseResultMap"
		parameterType="java.util.Map">
		select * from (
		select
		<include refid="Base_Column_List" />
		<include refid="selectPageCondition" />
		<if test="order != null">
	      		<![CDATA[  order by  ad.${order} ]]>
		</if>
		<if test="homePage != null">
	      		<![CDATA[  limit #{homePage.begin}, #{homePage.end} ]]>
		</if>
		) h
		<if test="page != null">
      		<![CDATA[  limit #{page.begin}, #{page.end} ]]>
		</if>
	</select>

	<select id="selectHomeCount" resultType="int" parameterType="java.util.Map">
		select count(1) from (
		select
		<include refid="Base_Column_List" />
		<include refid="selectPageCondition" />
		<if test="order != null">
	      		<![CDATA[  order by  ad.${order} ]]>
		</if>
		<if test="homePage != null">
	      		<![CDATA[  limit #{homePage.begin}, #{homePage.end} ]]>
		</if>
		) h
	</select>
	<select id="selectByAdvertId" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select id, advert_type, state,
		user_id, create_time,
		modify_time,
		start_time, end_time, red_envelope_type,
		red_envelope_amount,
		red_envelope_count, advert_name,
		advert_content,
		advert_condition_city,
		advert_condition_area,
		advert_condition_province,
		advert_condition_distance,
		advert_condition_sex,
		advert_condition_age_scope,website_name,salary_scope,time_scope,
		label_type,married,preferred_pic,relation_id,comment_size,praised_size
		from advert where id = #{id,jdbcType=BIGINT}
	</select>
	<select id="selectViewTimesCount" resultType="int"
		parameterType="java.util.Map">
		select IFNULL(sum(IFNULL(b.view_times,0)),0) count
		from
		advert a, advert_statistics b
		where a.id = b.advert_id and a.user_id =
		#{userId,jdbcType=BIGINT}
	</select>

	<!-- 首页福袋 -->
	<select id="homePageAdvert"
		resultType="com.mouchina.moumou_server.entity.vo.marketing.HomePageAdvertDo"
		parameterType="java.util.Map">
		SELECT
			*
		FROM
			(
				SELECT
					ad.id AS advertId,
					ad.user_id,
					ad.advert_content AS advertContent,
					ad.red_envelope_amount AS redEnvelopeAmount
				FROM advert ad
				WHERE ad.user_id = #{userId,jdbcType=BIGINT} AND ad.advert_type = 5
			) ad
		LEFT JOIN (
			SELECT
				re.advert_id AS re_advert_id,
				DATE_FORMAT(re.award_time, '%Y-%m-%d') AS date,
				SUM(amout) AS sumAmount
			FROM red_envelope re
			WHERE re.publisher_id = #{userId,jdbcType=BIGINT}
			GROUP BY date, advert_id
		) re ON re.re_advert_id = ad.advertId
		ORDER BY date DESC
		limit #{offset,jdbcType=INTEGER},#{pagesize,jdbcType=INTEGER}
	</select>
	<!-- 接力福袋营销 -->
	<select id="relayLuckBagAdvert"
		resultType="com.mouchina.moumou_server.entity.vo.marketing.RelayLuckBagAdvertDo"
		parameterType="java.util.Map">
		SELECT
			a.advert_type AS advertType,
			a.user_id AS userId,
			a.red_envelope_amount AS redEnvelopeAmount,
			a.create_time AS createTime,
			a.advert_content AS advertContent,
			IFNULL(a.red_envelope_amount, 0) + IFNULL(t1.amountSum, 0) AS amount,
			CASE WHEN isOpen=0 THEN '' WHEN isopen=1 THEN t1.user_nick_name END AS userNickName,
			t1.*
		FROM advert a
		LEFT JOIN (
			SELECT
				count(1) AS userViewCount,
				ABS(SUM(re.amout)) AS amountSum,
				a.state AS isPublish,
				re.advert_id AS advertId,
				isOpen1.user_nick_name,
				CASE WHEN IFNULL(isOpen1.amout,0) = 0 THEN 0 WHEN IFNULL(isOpen1.amout,0)>0 THEN 1 END AS isOpen
			FROM red_envelope re
			LEFT JOIN advert a ON (re.advert_id = a.id)
			LEFT JOIN (SELECT amout,advert_id,user_nick_name FROM red_envelope WHERE amout>0 AND type = 2) isOpen1 ON(isOpen1.advert_id=re.advert_id)
			WHERE re.type = 2
			GROUP BY re.advert_id
		) t1 ON (t1.advertId = a.id)
		WHERE a.user_id = #{userId,jdbcType=BIGINT} AND a.advert_type = 4
		ORDER BY a.create_time DESC	
		limit #{offset,jdbcType=INTEGER},#{pagesize,jdbcType=INTEGER}
	</select>

	<!-- 普通福袋 -->
	<select id="selectGeneralAdvert"
		resultType="com.mouchina.moumou_server.entity.vo.marketing.AdvertVo"
		parameterType="java.util.Map">
		SELECT
		ad.id,
		ad.advert_type AS advertType,
		ad.state,
		ad.user_id,
		ad.create_time AS createTime,
		ad.red_envelope_amount AS
		amount,
		ad.advert_content as advertContent,
		ree.*,
		ads.view_times AS
		viewCount
		FROM advert ad
		LEFT JOIN (
		SELECT
		re.advert_id AS advertId,
		COUNT(1) AS getRedEnvelopeCount
		FROM red_envelope re
		GROUP BY
		re.advert_id
		) ree ON (ad.id = ree.advertId)
		LEFT JOIN advert_statistics
		ads ON (ree.advertId = ads.advert_id)
		WHERE ad.user_id = #{userId,jdbcType=BIGINT} AND ad.advert_type = 0
		ORDER BY ad.create_time DESC
		limit #{offset,jdbcType=INTEGER},#{pagesize,jdbcType=INTEGER}
	</select>
	<!-- 优惠券营销数据 -->
	<select id="couponAdvert"
		resultType="com.mouchina.moumou_server.entity.vo.marketing.CouponAdvertVo"
		parameterType="java.util.Map">
		SELECT
		ad.id AS advertId,
		ad.advert_content as
		advertContent,
		ad.state AS state,
		ad.advert_type AS advertType,
		ad.relation_id AS relationId,
		ad.red_envelope_count AS
		redEnvelopeCount,
		ad.create_time AS createDate,
		bc.coupon_type AS
		couponType,
		bc.start_date AS startDate,
		bc.end_date AS endDate,
		bc.money
		as money,
		bc.discount as discount,
		bc.physical_volume as physicalVolume,
		case when re.useRedCount is null then 0 else re.useRedCount end as
		useRedCount,
		ads.send_red_envelope_count AS getRedCount
		FROM advert ad
		LEFT JOIN business_coupon bc
		ON(ad.relation_id = bc.id)
		LEFT JOIN
		(SELECT advert_id,COUNT(1) AS
		useRedCount FROM red_envelope ren WHERE
		ren.award_time IS NOT NULL AND
		ren.type=1 GROUP BY ren.advert_id) re
		ON(ad.id=re.advert_id) AND
		(ad.user_id = bc.user_id)
		LEFT JOIN
		advert_statistics ads
		ON(ad.id=ads.advert_id)
		WHERE ad.advert_type IN
		(1, 3) AND
		ad.user_id=#{userId,jdbcType=BIGINT}
		GROUP BY
		ad.advert_type,ad.relation_id
		limit
		#{offset,jdbcType=INTEGER},#{pagesize,jdbcType=INTEGER}
	</select>



	<select id="selectListBanner" resultMap="BannerBaseResultMap"
		parameterType="java.util.Map">
		select
		<include refid="Banner_Base_Column_List" />
		<include refid="selectBannerPageCondition" />
		<if test="order != null">
      		<![CDATA[  order by ${order} ]]>
		</if>
		<if test="page != null">
     		<![CDATA[  limit #{page.begin}, #{page.end} ]]>
		</if>
	</select>
	<select id="selectBannerCount" resultType="int" parameterType="java.util.Map">
		select count(1)
		<include refid="selectBannerPageCondition" />
	</select>
	<sql id="selectBannerPageCondition">
		from moumou.banner_config
		<where>
			<if test="id != null">
				and id = #{id,jdbcType=BIGINT}
			</if>
			<if test="picUrl != null">
				and pic_url = #{picUrl,jdbcType=VARCHAR}
			</if>
			<if test="secondLevelUrl != null">
				and second_level_url = #{secondLevelUrl,jdbcType=VARCHAR}
			</if>
			<if test="picIndex != null">
				and pic_index = #{picIndex,jdbcType=INTEGER}
			</if>
			<if test="bannerType != null">
				and banner_type = #{bannerType,jdbcType=INTEGER}
			</if>
			<if test="flag != null">
				and flag = #{flag,jdbcType=INTEGER}
			</if>
			<if test="createTimegt != null">
				and create_time <![CDATA[ >= ]]>
				#{createTimegt,jdbcType=TIMESTAMP}
			</if>
			<if test="createTimelt != null">
				and create_time <![CDATA[ <= ]]>
				#{createTimelt,jdbcType=TIMESTAMP}
			</if>
		</where>
	</sql>

	<insert id="insertBannerSelective"
		parameterType="com.mouchina.moumou_server.entity.advert.BannerConfig">
		insert into banner_config
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="picUrl != null">
				pic_url,
			</if>
			<if test="secondLevelUrl != null">
				second_level_url,
			</if>
			<if test="picIndex != null">
				pic_index,
			</if>
			<if test="bannerType != null">
				banner_type,
			</if>
			<if test="flag != null">
				flag,
			</if>
			<if test="createTime != null">
				create_time,
			</if>
			<if test="modifyTime != null">
				modify_time,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="picUrl != null">
				#{picUrl,jdbcType=VARCHAR},
			</if>
			<if test="secondLevelUrl != null">
				#{secondLevelUrl,jdbcType=VARCHAR},
			</if>
			<if test="picIndex != null">
				#{picIndex,jdbcType=INTEGER},
			</if>
			<if test="bannerType != null">
				#{bannerType,jdbcType=INTEGER},
			</if>
			<if test="flag != null">
				#{flag,jdbcType=INTEGER},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyTime != null">
				#{modifyTime,jdbcType=TIMESTAMP},
			</if>
		</trim>
		<selectKey resultType="java.lang.Long" order="AFTER"
			keyProperty="id">
			SELECT LAST_INSERT_ID() AS ID
		</selectKey>
	</insert>
	<update id="updateBannerByPrimaryKey"
		parameterType="com.mouchina.moumou_server.entity.advert.BannerConfig">
		update banner_config
		<set>
			<if test="picUrl != null">
				pic_url = #{picUrl,jdbcType=VARCHAR},
			</if>
			<if test="secondLevelUrl != null">
				second_level_url = #{secondLevelUrl,jdbcType=VARCHAR},
			</if>
			<if test="picIndex != null">
				pic_index = #{picIndex,jdbcType=INTEGER},
			</if>
			<if test="bannerType != null">
				banner_type = #{bannerType,jdbcType=INTEGER},
			</if>
			<if test="flag != null">
				flag = #{flag,jdbcType=INTEGER},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="modifyTime != null">
				modify_time = #{modifyTime,jdbcType=TIMESTAMP},
			</if>
		</set>
		where id = #{id,jdbcType=BIGINT}
	</update>
	<select id="selectAllPublicWelFare" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		SELECT
		<include refid="select_Advert_Base_Column_List" />
		FROM
		moumou.advert ad where ad.advert_type =
		#{advertType,jdbcType=INTEGER}
		<if test="order != null">
      		<![CDATA[  order by ${order} ]]>
		</if>
		<if test="page != null">
     		<![CDATA[  limit #{page.begin}, #{page.end} ]]>
		</if>
	</select>

	<!-- 查询公益广告及相关信息 -->
	<select id="selectPublicWelFareVoList" parameterType="java.util.Map"
		resultMap="PublicWelFaretVoMap">
		SELECT
		ad.id,
		ad.advert_type,
		ad.state,
		ad.advert_name,
		ad.advert_content,
		ad.create_time,
		ad.start_time,
		ads.send_red_envelope_count,
		ads.send_red_envelope_amount
		FROM
		moumou.advert ad INNER JOIN
		moumou.advert_statistics ads ON ad.id = ads.advert_id
		WHERE
		ad.advert_type = #{advertType,jdbcType=INTEGER}
		<if test="order != null">
      		<![CDATA[  order by ${order} ]]>
		</if>
		<if test="page != null">
     		<![CDATA[  limit #{page.begin}, #{page.end} ]]>
		</if>
	</select>
	<!-- 根据广告类型查询该类型记录条数 -->
	<select id="selectCountByType" parameterType="java.util.Map"
		resultType="int">
		SELECT
		COUNT(1)
		FROM
		moumou.advert
		WHERE advert_type =
		#{advertType,jdbcType=INTEGER}
	</select>

	<!-- 查询运营活动信息 -->
	<select id="selectOperateActivity" resultMap="BaseResultMap"
		parameterType="java.util.Map">
		select a.id, a.advert_name, a.preferred_pic
		<include refid="selectOperateActivityCondition" />
		<if test="order != null">
      		<![CDATA[  order by  a.${order} ]]>
		</if>
	</select>

	<sql id="selectOperateActivityCondition">
		from moumou.advert a, activity_config b where a.id = b.advert_id
		<if test="id != null">
			and a.id= #{id,jdbcType=BIGINT}
		</if>
		<if test="advertType != null">
			and a.advert_type= #{advertType,jdbcType=INTEGER}
		</if>
		<if test="advertTypes != null">
			and a.advert_type in (${advertTypes})
		</if>
		<if test="state != null">
			and a.state= #{state,jdbcType=INTEGER}
		</if>
		<if test="states != null">
			and a.state in (${states})
		</if>
		<if test="rank != null">
			and b.rank= #{rank,jdbcType=INTEGER}
		</if>
		<if test="showTime != null">
			and #{showTime,jdbcType=TIMESTAMP} 
			<![CDATA[ >= ]]>
			DATE_FORMAT(b.show_time,'%Y-%m-%d')
		</if>
		<if test="showTime != null">
			and #{showTime,jdbcType=TIMESTAMP} 
			<![CDATA[ <= ]]>
			DATE_FORMAT(a.end_time,'%Y-%m-%d')
		</if>
	</sql>
	<select id="selectListRangeAdvertByLike" resultMap="BaseResultMap"
		parameterType="java.util.Map">
		select
		<include refid="Base_Column_List" />
		<include refid="selectPageByLike" />
		<if test="order != null">
      		<![CDATA[  order by  ad.${order} ]]>
		</if>
		<if test="page != null">
      <![CDATA[  limit #{page.begin}, #{page.end} ]]>
		</if>
	</select>
	<sql id="selectPageByLike">
		from moumou.advert ad inner join moumou.business bs on ad.user_id =
		bs.user_id
		<where>
			<if test="advertContent != null">
				and ( bs.business_name LIKE CONCAT
				(
				'%','${advertContent}','%' )
				OR ad.advert_content LIKE CONCAT('%',
				'${advertContent}', '%') )
			</if>
			<if test="labelType != null">
				and ad.label_type =
				#{labelType,jdbcType=INTEGER}
			</if>
			<if test="advertTypes != null">
				and ad.advert_type in (${advertTypes})
			</if>
			<if test="states != null">
				and ad.state in (${states})
			</if>
		</where>
	</sql>
	<select id="selectCountByLike" resultType="int" parameterType="java.util.Map">
		select count(1)
		<include refid="selectPageByLike" />
	</select>
	<!-- 分页查询运营活动 -->
	<select id="selectListOperateTheActivity" resultMap="BaseResultMap"
		parameterType="java.util.Map">
		select
		<include refid="select_Advert_Base_Column_List" />
		from moumou.advert ad
		<where>
			<if test="advertType != NULL">
				and ad.advert_type= #{advertType,jdbcType=INTEGER}
			</if>
			<if test="state != NULL">
				and ad.state= #{state,jdbcType=INTEGER}
			</if>
		</where>
		<if test="order != null">
      <![CDATA[  order by  ad.${order} ]]>
		</if>
		<if test="page != null">
      <![CDATA[  limit #{page.begin}, #{page.end} ]]>
		</if>
	</select>
	<!-- 查询最近的一条XX广告 -->
	<select id="selectActivity" resultMap="BaseResultMap"
		parameterType="java.util.Map">
		select
		<include refid="select_Advert_Base_Column_List" />
		from moumou.advert ad
		WHERE advert_type =
		#{advertType,jdbcType=INTEGER} ORDER BY create_time DESC LIMIT 1
	</select>
</mapper>